# Google Maps Location Picker - User Guide

## ğŸ¯ Overview

The ambulance service now includes an **interactive Google Maps interface** where users can visually select the pickup location by searching for an address or clicking directly on the map!

---

## âœ¨ Features

### 1. Visual Location Selection
- ğŸ“ **Search by address** - Type and select from dropdown
- ğŸ–±ï¸ **Click on map** - Drop a pin anywhere
- ğŸ¯ **Drag marker** - Fine-tune the exact location
- ğŸ” **Auto-complete** - Get address suggestions as you type

### 2. Two Ways to Enter Location

**Option A: Type Address (Original)**
```
Enter: "Jl. Sudirman No. 45, Ponorogo"
â†“
Click "ğŸ“ Hitung Jarak via Google Maps"
```

**Option B: Pick from Map (NEW!)**
```
Click "ğŸ—ºï¸ Pilih di Peta" button
â†“
Interactive map opens
â†“
Search or click to select location
â†“
Click "âœ“ Gunakan Lokasi Ini"
â†“
Address automatically filled
```

---

## ğŸ® How to Use

### Step-by-Step Guide

**1. Open Ambulance Service Modal**
- Select "11. AMBULANCE" category
- Click "ğŸš‘ Tambah Layanan Ambulans"

**2. Choose Vehicle & Service Type**
- Select vehicle (GRANDMAX, etc.)
- Select service type (PASIEN, etc.)

**3. Select Pickup Location - Two Options:**

#### Option A: Type Address Manually
```
Type in the input box:
"Jl. Sudirman No. 45, Ponorogo"
```

#### Option B: Use Google Maps Picker
```
Click "ğŸ—ºï¸ Pilih di Peta" button
â†“
Google Maps modal opens
```

**4. In the Maps Picker Modal:**

**Method 1: Search**
```
Type in search box:
"Jl. Sudirman, Ponorogo"
â†“
Select from dropdown suggestions
â†“
Map centers on location
â†“
Marker appears
```

**Method 2: Click on Map**
```
Navigate the map (zoom, pan)
â†“
Click anywhere to drop pin
â†“
Marker appears at clicked location
```

**Method 3: Drag Marker**
```
Marker already on map
â†“
Click and drag to adjust
â†“
Address updates automatically
```

**5. Confirm Location**
```
Review selected address at bottom
â†“
Click "âœ“ Gunakan Lokasi Ini"
â†“
Modal closes
â†“
Address filled in ambulance form
```

**6. Calculate Distance**
```
Click "ğŸ“ Hitung Jarak via Google Maps"
â†“
Distance calculated automatically
â†“
Cost displayed
```

**7. Add to Visit**
```
Review cost
â†“
Click "âœ“ Tambah ke Tagihan"
```

---

## ğŸ–¼ï¸ Visual Guide

### Maps Picker Modal Layout

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ—ºï¸ Pilih Lokasi Penjemputan                              â”‚
â”‚ Cari alamat atau klik langsung di peta                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚ [Cari lokasi (contoh: Jl. Sudirman, Ponorogo)       ]   â”‚
â”‚ ğŸ’¡ Ketik alamat dan pilih dari dropdown, atau klik      â”‚
â”‚    langsung di peta                                      â”‚
â”‚                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                           â”‚
â”‚                    ğŸ—ºï¸ GOOGLE MAPS                        â”‚
â”‚                                                           â”‚
â”‚              [Interactive Map Here]                       â”‚
â”‚                                                           â”‚
â”‚                      ğŸ“ Marker                            â”‚
â”‚                                                           â”‚
â”‚              (Click anywhere to place)                    â”‚
â”‚              (Drag marker to adjust)                      â”‚
â”‚                                                           â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ ğŸ“ Lokasi Dipilih:                                        â”‚
â”‚ Jl. Sudirman No. 45, Ponorogo, Jawa Timur               â”‚
â”‚ Koordinat: -7.865300, 111.461900                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ [âœ“ Gunakan Lokasi Ini]  [Batal]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### Main Ambulance Form (Updated)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Lokasi Penjemputan *                                      â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚ â”‚ Jl. Sudirman No. 45, Ponorogo  â”‚ ğŸ—ºï¸ Pilih di Peta â”‚    â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚ Ketik alamat atau klik "ğŸ—ºï¸ Pilih di Peta" untuk          â”‚
â”‚ memilih lokasi secara visual                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ Key Features

### Interactive Map

**What You Can Do:**
- âœ… **Zoom In/Out** - Mouse wheel or +/- buttons
- âœ… **Pan** - Click and drag to move around
- âœ… **Search** - Type address in search box
- âœ… **Click to Place** - Click anywhere to drop pin
- âœ… **Drag Marker** - Adjust exact position
- âœ… **Street View** - See the location (if available)
- âœ… **Map/Satellite Toggle** - Switch views

### Auto-Complete Search

**Features:**
- ğŸ” Real-time suggestions as you type
- ğŸŒ Biased to current map viewport
- ğŸ¯ Accurate address resolution
- ğŸ“ Automatic marker placement

### Address Display

**Shows:**
- ğŸ“ Full formatted address
- ğŸŒ GPS coordinates (latitude, longitude)
- ğŸ”„ Updates in real-time as marker moves

---

## ğŸ’¡ Tips & Best Practices

### For Accurate Location

âœ… **DO:**
- Use the search box for known addresses
- Zoom in before clicking on map
- Drag marker for fine-tuning
- Verify the address before confirming
- Check the coordinates if needed

âŒ **DON'T:**
- Click randomly without zooming
- Skip verifying the address
- Use vague search terms
- Forget to confirm selection

### For Efficiency

âœ… **Quick Method:**
```
1. Type street name in search
2. Select from dropdown
3. Drag marker if needed
4. Confirm
```

âœ… **Precise Method:**
```
1. Zoom into area
2. Click exact location
3. Verify address
4. Confirm
```

---

## ğŸ”§ Technical Details

### What Happens Behind the Scenes

**When You Select a Location:**

1. **Search Entry:**
   ```
   User types: "Jl. Sudirman"
   â†“
   Google Places API returns suggestions
   â†“
   User selects one
   â†“
   Map centers + marker placed
   â†“
   Address + coordinates captured
   ```

2. **Map Click:**
   ```
   User clicks map
   â†“
   Coordinates captured
   â†“
   Reverse geocoding via Google API
   â†“
   Address resolved
   â†“
   Display to user
   ```

3. **Marker Drag:**
   ```
   User drags marker
   â†“
   New coordinates captured
   â†“
   Reverse geocoding
   â†“
   Address updated
   ```

### Data Stored

When you select a location, the system stores:
```javascript
{
  pickupLocation: "Jl. Sudirman No. 45, Ponorogo, Jawa Timur",
  // (latitude and longitude available but not currently stored)
}
```

**Note:** Currently only the formatted address is stored. Future versions may include GPS coordinates for additional features.

---

## ğŸ†˜ Troubleshooting

### Map Not Loading

**Possible Causes:**
- API key missing
- Network issue
- Script loading error

**Solutions:**
1. Check internet connection
2. Refresh page
3. Check console for errors
4. Contact IT if persistent

### Search Not Working

**Possible Causes:**
- Places API not enabled
- API quota exceeded
- Invalid search term

**Solutions:**
1. Try clicking on map instead
2. Use more specific address
3. Check API quota in Google Console
4. Contact administrator

### Can't Find Location

**Solutions:**
1. Try searching differently:
   - "Jl. Sudirman, Ponorogo" instead of just "Sudirman"
   - Use full address
   - Include village/district name

2. Use map navigation:
   - Zoom out to see area
   - Pan to approximate location
   - Zoom in and click

3. Manual fallback:
   - Close map picker
   - Type address manually
   - Use manual distance input

### Marker Won't Move

**Solutions:**
1. Ensure you're clicking and holding
2. Try placing new marker (click elsewhere)
3. Refresh and try again
4. Use manual address input

---

## ğŸ“Š Comparison

### Old Method vs New Method

| Feature | Type Address | Pick from Map |
|---------|-------------|---------------|
| **Speed** | Fast if known | Fast once found |
| **Accuracy** | Good | Excellent |
| **Ease** | Easy | Very easy |
| **Visual** | No | Yes |
| **Verification** | Manual | Visual |
| **Precision** | Address-level | GPS-level |

### When to Use Each

**Type Address:**
- âœ… You know the exact address
- âœ… Quick entry needed
- âœ… Familiar location
- âœ… Address is complete

**Pick from Map:**
- âœ… Don't know exact address
- âœ… Need visual confirmation
- âœ… Want to see the area
- âœ… Precise location needed
- âœ… First time to location

---

## ğŸ“ Example Scenarios

### Scenario 1: Well-Known Address

**Task:** Patient at "Jl. Sudirman No. 45"

**Best Method:** Type address
```
1. Type "Jl. Sudirman No. 45, Ponorogo"
2. Click "ğŸ“ Hitung Jarak"
3. Done!
```
**Time:** 10 seconds

### Scenario 2: Vague Description

**Task:** "Patient near the market"

**Best Method:** Pick from map
```
1. Click "ğŸ—ºï¸ Pilih di Peta"
2. Search "Pasar Ponorogo"
3. Navigate to nearby street
4. Click on exact location
5. Confirm
6. Calculate distance
```
**Time:** 30 seconds

### Scenario 3: Rural Area

**Task:** "Patient in Desa Kauman"

**Best Method:** Pick from map
```
1. Click "ğŸ—ºï¸ Pilih di Peta"
2. Search "Desa Kauman, Ponorogo"
3. Zoom in to see roads
4. Click on patient's location
5. Verify address shows village name
6. Confirm
```
**Time:** 45 seconds

### Scenario 4: Verify Unfamiliar Address

**Task:** "Jl. Melati No. 12" (never been there)

**Best Method:** Combine both
```
1. Type "Jl. Melati No. 12, Ponorogo"
2. Click "ğŸ—ºï¸ Pilih di Peta" to verify
3. Check map shows correct area
4. Adjust marker if needed
5. Confirm
```
**Time:** 20 seconds

---

## âœ… Benefits

### For Users

âœ… **Visual Confirmation** - See exactly where you're sending the ambulance  
âœ… **No Address Errors** - Pick directly from map  
âœ… **Faster Selection** - Click instead of typing  
âœ… **Better Accuracy** - GPS-level precision  
âœ… **Familiar Interface** - Everyone knows Google Maps  

### For Hospital

âœ… **Fewer Mistakes** - Visual selection reduces errors  
âœ… **Better Documentation** - Exact coordinates available  
âœ… **Faster Dispatch** - Clear location for drivers  
âœ… **Professional** - Modern, user-friendly interface  
âœ… **Verification** - Staff can verify location visually  

### For Patients/Family

âœ… **Clear Communication** - Visual confirmation of pickup point  
âœ… **Accurate Service** - Ambulance goes to exact location  
âœ… **No Confusion** - Map shows precise location  
âœ… **Confidence** - See the location before confirming  

---

## ğŸš€ Status

**Implementation:** âœ… **COMPLETE**

**Features Working:**
- âœ… Interactive Google Maps
- âœ… Search box with autocomplete
- âœ… Click to place marker
- âœ… Drag marker to adjust
- âœ… Reverse geocoding
- âœ… Address display
- âœ… Coordinate display
- âœ… Confirmation button
- âœ… Integration with ambulance form

**To Use:**
1. Ensure Firebase credentials added (for authentication)
2. Google Maps API key already configured âœ…
3. Restart server if needed
4. Navigate to visit â†’ Ambulance service
5. Click "ğŸ—ºï¸ Pilih di Peta"
6. Enjoy the interactive map! ğŸ‰

---

**The ambulance service now has a professional, visual location picker powered by Google Maps!** ğŸ—ºï¸âœ¨

